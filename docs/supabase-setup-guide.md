# Supabase数据库设置指南

## 🎯 目标
在Supabase中创建用户登录和查询记录相关的数据库表

## 📋 操作步骤

### 第一步：打开Supabase SQL编辑器

1. **访问您的Supabase项目**
   - 打开 [https://syryqvbhfvjbctrdxcbv.supabase.co](https://syryqvbhfvjbctrdxcbv.supabase.co)
   - 或者从 [supabase.com](https://supabase.com) 进入您的项目

2. **找到SQL编辑器**
   - 在左侧菜单中找到 "SQL Editor"（SQL编辑器）
   - 点击进入

### 第二步：执行SQL脚本

1. **复制SQL代码**
   - 打开项目中的 `docs/database-setup.sql` 文件
   - 全选并复制所有内容（Ctrl+A, Ctrl+C）

2. **粘贴到SQL编辑器**
   - 在Supabase SQL编辑器中粘贴代码（Ctrl+V）
   - 确保所有代码都完整复制

3. **执行SQL脚本**
   - 点击右下角的 "Run" 按钮
   - 等待执行完成（通常需要几秒钟）

### 第三步：验证创建结果

1. **检查表格是否创建成功**
   - 在左侧菜单中点击 "Table Editor"（表编辑器）
   - 您应该看到以下新表格：
     - `user_profiles` - 用户资料表
     - `word_queries` - 查询历史表
     - `user_query_limits` - 查询限制表

2. **检查表格结构**
   - 点击每个表格，查看字段是否正确
   - 确保没有错误提示

## 🔧 技术说明

### 我们创建了什么？

1. **用户资料表 (user_profiles)**
   - 存储用户的昵称、头像等信息
   - 自动关联到Supabase的内置用户系统

2. **查询历史表 (word_queries)**
   - 记录每次单词查询的详细信息
   - 包括查询的单词、参数、AI返回的结果

3. **查询限制表 (user_query_limits)**
   - 控制每个用户的每日查询次数
   - 免费用户每天100次查询
   - 每天自动重置计数

4. **安全机制**
   - **行级安全 (RLS)**: 确保用户只能看到自己的数据
   - **自动触发器**: 新用户注册时自动创建资料
   - **数据完整性**: 防止数据错误和恶意操作

### 为什么这样设计？

- **数据隔离**: 每个用户的数据完全分离，保护隐私
- **自动化**: 减少手动操作，提高系统可靠性
- **性能优化**: 创建索引提高查询速度
- **可扩展性**: 设计支持未来功能扩展

## ⚠️ 注意事项

### 如果执行出错

1. **检查错误信息**
   - 仔细阅读错误提示
   - 常见错误通常是语法问题

2. **重新执行**
   - 清空SQL编辑器内容
   - 重新复制粘贴完整的SQL脚本
   - 确保没有遗漏任何代码

3. **联系技术支持**
   - 如果持续出错，请提供错误截图
   - 我们会协助解决问题

### 数据安全

- **备份**: Supabase自动备份，无需担心数据丢失
- **权限**: 只有项目管理员可以修改数据库结构
- **监控**: 可以在Supabase控制台查看所有数据操作

## ✅ 完成检查

执行完成后，请检查：

- [ ] 所有SQL语句都执行成功（没有红色错误提示）
- [ ] 在Table Editor中看到3个新表格
- [ ] 每个表格都有正确的字段
- [ ] 没有任何错误或警告信息

## 🎉 下一步

数据库设置完成后，我们就可以开始：
1. 设置用户认证界面
2. 连接前端到数据库
3. 实现查询限制功能

---

*有任何问题，请随时询问！*